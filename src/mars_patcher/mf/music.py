from mars_patcher.mf.auto_generated_types import MarsschemamfMusicmapping
from mars_patcher.mf.constants.game_data import sounds
from mars_patcher.rom import Rom

MUSIC_LIBRARY = {
    "MUSIC_NONE": 0x0,
    "MUSIC_1": 0x1,
    "MUSIC_2": 0x2,
    "MUSIC_3": 0x3,
    "MUSIC_SECTOR_1": 0x4,
    "MUSIC_5": 0x5,
    "MUSIC_SECTOR_2": 0x6,
    "MUSIC_SECTOR_3": 0x7,
    "MUSIC_SECTOR_5": 0x8,
    "MUSIC_SECTOR_4": 0x9,
    "MUSIC_SECTOR_6": 0xA,
    "MUSIC_NAVIGATION_ROOM": 0xB,
    "MUSIC_C": 0xC,
    "MUSIC_D": 0xD,
    "MUSIC_E": 0xE,
    "MUSIC_F": 0xF,
    "MUSIC_ITEM_FANFARE": 0x10,
    "MUSIC_11": 0x11,
    "MUSIC_12": 0x12,
    "MUSIC_13": 0x13,
    "SOUND_MESSAGE_POPUP": 0x14,
    "MUSIC_15": 0x15,
    "MUSIC_16": 0x16,
    "MUSIC_SA_X_CHASE": 0x17,
    "MUSIC_BOSS_TENSION": 0x18,
    "MUSIC_ARACHNUS_BATTLE": 0x19,
    "MUSIC_ZAZABI_BATTLE": 0x1A,
    "MUSIC_BOX_BATTLE": 0x1B,
    "MUSIC_1C": 0x1C,
    "MUSIC_1D": 0x1D,
    "MUSIC_1E": 0x1E,
    "MUSIC_1F": 0x1F,
    "MUSIC_20": 0x20,
    "MUSIC_21": 0x21,
    "MUSIC_22": 0x22,
    "MUSIC_23": 0x23,
    "MUSIC_24": 0x24,
    "MUSIC_25": 0x25,
    "MUSIC_26": 0x26,
    "MUSIC_27": 0x27,
    "MUSIC_28": 0x28,
    "MUSIC_29": 0x29,
    "MUSIC_2A": 0x2A,
    "MUSIC_2B": 0x2B,
    "MUSIC_2C": 0x2C,
    "MUSIC_2D": 0x2D,
    "MUSIC_2E": 0x2E,
    "MUSIC_2F": 0x2F,
    "MUSIC_30": 0x30,
    "MUSIC_31": 0x31,
    "MUSIC_32": 0x32,
    "MUSIC_OPERATIONS_DECK_ELEVATOR_OFFLINE": 0x33,
    "MUSIC_OPERATIONS_DECK_ELEVATOR_OFFLINE_AMBIENCE": 0x34,
    "MUSIC_MAIN_BOILER_COOLDOWN_MISSION": 0x35,
    "MUSIC_36": 0x36,
    "MUSIC_37": 0x37,
    "MUSIC_ORBIT_CHANGE": 0x38,
    "MUSIC_39": 0x39,
    "MUSIC_3A": 0x3A,
    "MUSIC_OBJECTIVE_COMPLETE": 0x3B,
    "MUSIC_3C": 0x3C,
    "MUSIC_3D": 0x3D,
    "MUSIC_3E": 0x3E,
    "MUSIC_SERRIS_YAKUZA_BATTLE": 0x3F,
    "MUSIC_VARIA_CORE_X_BATTLE": 0x40,
    "MUSIC_NIGHTMARE_BATTLE": 0x41,
    "MUSIC_NEO_RIDLEY_BATTLE": 0x42,
    "MUSIC_CHOZO_STATUE_CORE_X_BATTLE": 0x43,
    "MUSIC_NETTORI_BATTLE": 0x44,
    "MUSIC_45": 0x45,
    "MUSIC_46": 0x46,
    "MUSIC_47": 0x47,
    "MUSIC_48": 0x48,
    "MUSIC_49": 0x49,
    "MUSIC_TITLE": 0x4A,
    "MUSIC_4B": 0x4B,
    "MUSIC_4C": 0x4C,
    "MUSIC_4D": 0x4D,
    "MUSIC_4E": 0x4E,
    "MUSIC_4F": 0x4F,
    "MUSIC_50": 0x50,
    "MUSIC_SA_X_BATTLE": 0x51,
    "MUSIC_52": 0x52,
    "MUSIC_53": 0x53,
    "MUSIC_54": 0x54,
    "MUSIC_55": 0x55,
    "MUSIC_56": 0x56,
    "MUSIC_57": 0x57,
    "MUSIC_58": 0x58,
    "MUSIC_59": 0x59,
    "MUSIC_5A": 0x5A,
    "MUSIC_5B": 0x5B,
    "MUSIC_5C": 0x5C,
    "MUSIC_5D": 0x5D,
    "MUSIC_5E": 0x5E,
    "MUSIC_5F": 0x5F,
    "MUSIC_60": 0x60,
    "MUSIC_61": 0x61,
    "MUSIC_62": 0x62,
    "MUSIC_63": 0x63,
}


def set_sounds(rom: Rom, patch_data: MarsschemamfMusicmapping) -> None:
    # Write to rom
    read_location = sounds(rom) + 8 * MUSIC_LIBRARY[patch_data["New"]]
    read_SoundheaderPtr = rom.read_32(read_location)
    read_TrackGroupNum1 = rom.read_16(read_location + 4)
    read_TrackGroupNum2 = rom.read_16(read_location + 6)
    write_location = sounds(rom) + 8 * MUSIC_LIBRARY[patch_data["Original"]]
    rom.write_32(write_location, read_SoundheaderPtr)
    rom.write_16(write_location + 4, read_TrackGroupNum1)
    rom.write_16(write_location + 6, read_TrackGroupNum2)
